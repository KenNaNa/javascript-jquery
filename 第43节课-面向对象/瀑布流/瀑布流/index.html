<!doctype html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<title>瀑布流</title>
		<style type="text/css">
			* {
				margin: 0;
				padding: 0;
			}

			body {
				color: #666666;
				font-family:Arial;
				font-size:13px;
				letter-spacing: 1px;
				text-align:left;
				background: #f4f4f4;
				font-family:Arial,"微软雅黑","microsoft yahei";
			}

			img {
				border:none;
			}

			.main .block{
				float: left;
			}

			.main .block .box{
				width: 250px;
				padding: 10px;
				margin: 5px 7px;
				background: #ffffff;
			}

			.main .block .box img {
				display: block;
				width: 250px;
			}

		</style>		
		<script type="text/javascript" src="jQuery-1.3.1.min.js"></script>
		<script type="text/javascript">
			if (navigator.appVersion.search(/MSIE 6/i) != -1){
				//IE6
				$(document).ready(function(){
					web();
				});
			}else{
				window.onload = function() {
					web();
				}
			}

			function web() {
				var client_width = document.body.clientWidth; //网页可见区域宽
				//窗口变化执行
				web_width(client_width);

				var block_width = $(".block").eq(0).width();
				var line_count = Math.floor(client_width/block_width);

				$(".main").css("width",line_count*block_width+"px").css("margin","0 auto"); //居中

				var block_array = [];
				for(var i=0;i<$(".block").length;i++){
					if(i<line_count){
						block_array[i] = $(".block").eq(i).height();
					}else{
						var min_height = Math.min.apply('',block_array); //获取数组中最小值
						var min_key = get_min_key(block_array,min_height); //获取数组中最小值对应的键值
						$(".block").eq(i).css("position","absolute").css("top",min_height+"px").css("left",$(".block").eq(min_key).offset().left+"px");
						block_array[min_key] += $(".block").eq(i).height();
					}
				}				
			}

			//获取数组的键值
			function get_min_key(block_array,min_height){
				for(key in block_array){
					if(block_array[key] == min_height){
						return key;
					}
				}
			}

			function web_width(client_width) {
				if(client_width != document.body.clientWidth){
					var url = location.href;
					location.href = url;
				}

				setTimeout(function() {web_width(client_width)},100);
			}

		</script>
	</head>
	<body>
		<div class="main">
			<div class="block">
				<div class="box">
					<img src="images/1.jpg">
				</div>
			</div>
			<div class="block">
				<div class="box">
					<img src="images/2.jpg">
				</div>
			</div>
			<div class="block">
				<div class="box">
					<img src="images/3.jpg">
				</div>
			</div>
			<div class="block">
				<div class="box">
					<img src="images/4.jpg">
				</div>
			</div>
			<div class="block">
				<div class="box">
					<img src="images/5.jpg">
				</div>
			</div>
			<div class="block">
				<div class="box">
					<img src="images/6.jpg">
				</div>
			</div>
			<div class="block">
				<div class="box">
					<img src="images/7.jpg">
				</div>
			</div>
			<div class="block">
				<div class="box">
					<img src="images/8.jpg">
				</div>
			</div>			
			<div class="block">
				<div class="box">
					<img src="images/1.jpg">
				</div>
			</div>
			<div class="block">
				<div class="box">
					<img src="images/2.jpg">
				</div>
			</div>
			<div class="block">
				<div class="box">
					<img src="images/3.jpg">
				</div>
			</div>
			<div class="block">
				<div class="box">
					<img src="images/4.jpg">
				</div>
			</div>
			<div class="block">
				<div class="box">
					<img src="images/5.jpg">
				</div>
			</div>
			<div class="block">
				<div class="box">
					<img src="images/6.jpg">
				</div>
			</div>
			<div class="block">
				<div class="box">
					<img src="images/1.jpg">
				</div>
			</div>
			<div class="block">
				<div class="box">
					<img src="images/2.jpg">
				</div>
			</div>
			<div class="block">
				<div class="box">
					<img src="images/3.jpg">
				</div>
			</div>
			<div class="block">
				<div class="box">
					<img src="images/4.jpg">
				</div>
			</div>
			<div class="block">
				<div class="box">
					<img src="images/5.jpg">
				</div>
			</div>
			<div class="block">
				<div class="box">
					<img src="images/6.jpg">
				</div>
			</div>			
		</div>
	</body>
</html>